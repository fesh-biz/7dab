(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{b2c5:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex column justify-center q-px-md",staticStyle:{height:"100vh"}},[r("q-form",{attrs:{dusk:"l-login-form"},on:{submit:e.onSubmit}},[r("q-card",[r("q-card-section",[r("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("login")))])]),r("q-separator"),r("q-card-section",[r("q-input",{attrs:{dusk:"l-email-input",outlined:"",dense:"",autocomplete:"username",label:e.$t("email"),error:!!e.validator.errors.email,"error-message":e.validator.errors.email},on:{input:function(t){return e.validator.resetErrors()}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),r("q-input",{attrs:{dusk:"l-password-input",outlined:"",dense:"",autocomplete:"current-password",type:"password",label:e.$t("password"),error:!!e.validator.errors.password,"error-message":e.validator.errors.password},on:{input:function(t){return e.validator.resetErrors()}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e.validator.errors.error_message?r("q-banner",{staticClass:"text-white bg-red q-mb-md",attrs:{dusk:"l-error-message",rounded:"","inline-actions":""}},[e._v("\n          "+e._s(e.validator.errors.error_message)+"\n        ")]):e._e(),r("q-item",{attrs:{dusk:"l-forgot-password-link",to:{name:"forgot_password"},clickable:""}},[r("q-item-section",[e._v(e._s(e.$t("forgot_your_password"))+"?")])],1)],1),r("q-separator"),r("q-card-actions",{staticClass:"q-pa-md"},[r("q-btn",{attrs:{dusk:"l-login-form-submit",disable:e.formIsBusy,loading:e.formIsBusy,label:e.$t("log_in"),type:"submit",color:"primary"}})],1)],1)],1)],1)},a=[],o=r("6357"),n=(r("e6cf"),r("77fc"));class i{constructor(){if(i.instance)return i.instance;this.api=new n["a"],this.token=null,this.expiresIn=null,i.instance=this}createToken(e,t){return new Promise(((r,s)=>{this.api.post("token",{grant_type:"password",client_id:2,client_secret:"sFKCIaMm0CcttGi21C2d3nYfzebevgB4owYad5SM",username:e,password:t},null,null,!0).then((e=>r(e))).catch((e=>{s(e)}))}))}refreshToken(){return new Promise(((e,t)=>{this.api.post("/oauth/token").then((t=>{e(t)})).catch((e=>{console.error(e),t(e)}))}))}}var l=r("ce77"),c=r("7a4a"),u=r("891a"),d=r("b65d");const m={email:null,password:null};var p={name:"Login",data(){return{form:m,formIsBusy:!1,validator:new o["a"](m),tokenApi:new i,userApi:new l["a"],tokenCookies:new c["a"],meCookies:new d["a"],api:new n["a"]}},methods:{onSubmit(){this.formIsBusy=!0,this.tokenApi.createToken(this.form.email,this.form.password).then((e=>{this.formIsBusy=!1,this.tokenCookies.set(e.data),this.api.setBearer(this.tokenCookies.getAuthorizationToken()),this.userApi.fetchMe().then((e=>{const t=e.data;this.meCookies.set(t),u["a"].create({data:t}),this.$router.push({name:"home"})}))})).catch((e=>{this.formIsBusy=!1,this.validator.setErrors(e)}))}}},f=p,h=r("2877"),w=r("0378"),k=r("f09f"),b=r("a370"),v=r("eb85"),g=r("27f9"),_=r("54e1"),q=r("66e5"),C=r("4074"),y=r("4b7e"),I=r("9c40"),B=r("eebe"),Q=r.n(B),$=Object(h["a"])(f,s,a,!1,null,null,null);t["default"]=$.exports;Q()($,"components",{QForm:w["a"],QCard:k["a"],QCardSection:b["a"],QSeparator:v["a"],QInput:g["a"],QBanner:_["a"],QItem:q["a"],QItemSection:C["a"],QCardActions:y["a"],QBtn:I["a"]})}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"0d8b":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"row justify-center q-px-sm"},[e("div",{staticClass:"col-sm-12 col-xs-12 col-md-8 col-lg-6 col-xl-5"},[t.fetching.posts?e("q-linear-progress",{class:{"q-mt-md":!t.$q.platform.is.mobile},attrs:{indeterminate:""}}):t._e(),t._l(t.posts,(function(t,s){return e("post",{key:"post"+s,attrs:{post:t}})})),t.mainPage.isLastFetched?e("q-banner",{staticClass:"text-center",attrs:{dusk:"main-no-more-posts",rounded:""}},[t._v("\n      "+t._s(t.$t("there_is_no_new_posts"))+"\n    ")]):t._e(),t.fetching.posts&&t.posts.length?e("q-linear-progress",{staticClass:"q-mb-xl",attrs:{dusk:"main-new-posts-loading",indeterminate:""}}):t._e()],2)])},n=[],o=(e("e6cf"),e("5e86")),i=e("f9a5"),c=e("7cbd"),r=e("09ad");class l{constructor(){if(l.instance)return l.instance;this.isLastFetched=!1,this.currentPage=0,l.instance=this}}var h={name:"FeedMain",components:{Post:i["a"]},data(){return{fetching:{posts:!1},mainPage:new l,postApi:new c["a"],scroll:new r["a"]}},computed:{posts(){return o["a"].query().withAll().orderBy("id","desc").all()}},async created(){this.posts.length<2&&(await o["a"].deleteAll(),this.fetchPosts(!0))},mounted(){window.addEventListener("scroll",this.maybeFetchNextPosts)},methods:{scrollToPost(t){const s=document.getElementById(t);s?setTimeout((()=>{s.scrollIntoView({behavior:"smooth"})}),100):setTimeout((()=>{this.scrollToPost(t)}),100)},maybeFetchNextPosts(){this.fetching.posts||!this.scroll.isScrollBottom(500)||this.mainPage.isLastFetched||this.fetchPosts()},fetchPosts(t){this.fetching.posts=!0,this.postApi.fetchPosts(++this.mainPage.currentPage).then((s=>{t?o["a"].create({data:s.data.data}):o["a"].insert({data:s.data.data}),this.mainPage.isLastFetched=s.data.meta.is_last,this.fetching.posts=!1})).catch((()=>{this.fetching.posts=!1}))}},beforeDestroy(){window.removeEventListener("scroll",this.maybeFetchNextPosts)}},d=h,m=e("2877"),p=e("6b1d"),u=e("54e1"),f=e("eebe"),g=e.n(f),w=Object(m["a"])(d,a,n,!1,null,null,null);s["default"]=w.exports;g()(w,"components",{QLinearProgress:p["a"],QBanner:u["a"]})}}]);
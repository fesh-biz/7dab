(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"01a2":function(t,e,s){"use strict";s("247c")},"247c":function(t,e,s){},"4f9d":function(t,e,s){"use strict";s.d(e,"a",(function(){return d}));s("e6cf");var i=s("6357"),a=s("7cbd"),n=s("2ef0"),o=s.n(n),r=s("5e86"),l=s("2a19");const c={title:"",sections:[],tags:[]};class d{constructor(){if(d.instance)return d.instance;this.formModel=o.a.cloneDeep(c),this.api=new a["a"],this.validator=new i["a"](c),d.instance=this}addSection(t,e,s){const i=this.formModel.sections.length?this.formModel.sections[this.formModel.sections.length-1].order+1:1;this.formModel.sections.push({id:s,order:i,type:t,content:e||null})}addSections(t,e,s){s.forEach((e=>{e instanceof File&&this.addSection(t,{file:e})}))}deleteSection(t){const e=this.formModel.sections[t];this.formModel.sections.splice(t,1),this.validator.resetFieldError("sections",e.order)}fillFormModel(t){this.formModel=o.a.cloneDeep(c);const e=r["a"].query().withAll().find(t);this.formModel.title=e.title,e.content.forEach((t=>{"text"===t.type&&this.addSection("text",t.body,t.id),"image"===t.type&&this.addSection("image",{url:t.original_file_path,title:t.title},t.id)}));const s=[];e.tags.forEach((t=>{s.push({label:t.title,value:t.id})})),this.formModel.tags=s}updateSection(t,e){const s=o.a.find(this.formModel.sections,{order:t});"text"!==s.type?"image"===s.type&&(s.content=s.content||{file:null,url:null,title:null},s.content=Object.assign(s.content,e)):s.content=e}resetFormModel(){this.formModel=o.a.cloneDeep(c)}getFormData(){const t=this.formModel,e=new FormData;e.append("title",t.title);for(let s=0;s<t.sections.length;s++){const i=t.sections[s];if(i.id&&e.append(`sections[${s}][id]`,i.id),e.append(`sections[${s}][type]`,i.type),e.append(`sections[${s}][order]`,i.order),"image"===i.type){if(!i.content)continue;i.content.file&&e.append(`sections[${s}][content][file]`,i.content.file),e.append(`sections[${s}][content][url]`,i.content.url||""),e.append(`sections[${s}][content][title]`,i.content.title||"")}"text"===i.type&&e.append(`sections[${s}][content]`,i.content||"")}for(let s=0;s<t.tags.length;s++){const i=t.tags[s];i.value?e.append(`tags[${s}][id]`,i.value):e.append(`tags[${s}][new]`,i)}return e}clearAllEmptyFields(){this.formModel.sections=this.formModel.sections.filter((t=>t.content))}saveOrUpdate(t){return new Promise(((e,s)=>{if(this.clearAllEmptyFields(),!this.formModel.sections.length)return l["a"].create({position:"center",color:"negative",message:"Теревенька маэ мати хоча б одне текстове поле або поле з зображенням"}),s();const i=this.getFormData(),a=t?"update":"store";this.api[a](i,t).then((t=>e(t))).catch((t=>{this.validator.setErrors(t),s(t)}))}))}}},"51d9":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-icon",{staticClass:"cursor-pointer",class:{"iwt-disabled":this.disabled},attrs:{name:t.icon,color:t.color,size:t.size},on:{click:t.click}},[s("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale",self:"bottom middle",anchor:"top middle"}},[t._v("\n    "+t._s(t.tooltip)+"\n  ")])],1)},a=[],n={name:"IconWithToolTip",props:{icon:{type:String,required:!0},tooltip:{type:String,required:!0},color:{type:String,default:""},size:{type:String,default:"md"},disabled:{type:Boolean,default:!1}},data(){return{}},methods:{click(){this.disabled||this.$emit("click")}}},o=n,r=(s("8643"),s("2877")),l=s("0016"),c=s("05c0"),d=s("eebe"),p=s.n(d),u=Object(r["a"])(o,i,a,!1,null,null,null);e["a"]=u.exports;p()(u,"components",{QIcon:l["a"],QTooltip:c["a"]})},5440:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"wrapper",staticClass:"flex justify-center",class:{error:t.errorMessage}},[t.isImageAdded||t.content&&t.content.url?s("div",{staticStyle:{width:"100%"}},[s("icon-with-tooltip",{staticClass:"cursor-pointer",attrs:{size:"2rem",icon:"change_circle",tooltip:t.$t("change_image")},on:{click:t.addImages}})],1):t._e(),t.isImageAdded?t._e():s("q-icon",{staticClass:"cursor-pointer",staticStyle:{"background-color":"white"},attrs:{size:"10rem",color:"blue-grey-2",name:"add_a_photo"},on:{click:t.addImages}}),s("canvas",{ref:"canvas",attrs:{width:this.wrapperWidth,height:"0"}}),s("q-input",{staticStyle:{width:"100%"},attrs:{dense:"",label:t.$t("add_image_label"),"stack-label":""},on:{input:t.input},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t.errorMessage?s("span",{staticStyle:{color:"red",width:"100%"}},[t._v(t._s(t.errorMessage))]):t._e()],1)},a=[],n=(s("e6cf"),s("51d9")),o=s("4f9d"),r={name:"ImageField",components:{IconWithTooltip:n["a"]},props:{content:{type:Object,default:null},order:{type:Number,required:!0},errorMessage:{type:[String]}},data(){return{wrapperWidth:0,isImageAdded:!1,postEditor:new o["a"]}},computed:{title:{get(){var t;return(null===(t=this.content)||void 0===t?void 0:t.title)||""},set(t){this.postEditor.updateSection(this.order,{title:t})}}},async mounted(){this.wrapperWidth=this.$refs.wrapper.offsetWidth,this.content?this.content.file?this.drawImage(this.content.file):this.content.url&&this.drawImageFromUrl(this.content.url):this.addImages()},methods:{input(){this.$emit("input")},addImages(){this.$emit("input");const t=document.createElement("input");t.type="file",t.multiple=!0,t.onchange=t=>{this.handleImages(t.target.files)},t.click()},drawImage(t){const e=this.$refs.canvas,s=e.getContext("2d"),i=new FileReader;i.onload=t=>{const i=new Image;i.onload=()=>{let t=i.width,a=i.height;t>this.wrapperWidth&&(a*=this.wrapperWidth/t,t=this.wrapperWidth),e.width=t,e.height=a,s.drawImage(i,0,0,i.width,i.height,0,0,t,a),this.isImageAdded=!0},i.src=t.target.result},i.readAsDataURL(t)},async drawImageFromUrl(t){const e=await fetch(t),s=await e.blob(),i={type:"image/jpeg"};let a=t;a=a.substr(a.lastIndexOf("/")+1);const n=new File([s],a,i);this.drawImage(n)},handleImages(t){const e=this.validateImages(t);if(e)return void this.$q.notify({message:e,position:"center",color:"negative"});const s=t[0];this.drawImage(s),this.postEditor.updateSection(this.order,{file:s});const i=[];for(let a=0;a<t.length;a++)a>0&&i.push(t[a]);this.postEditor.addSections("image",this.order,i)},validateImages(t){let e=null;const s=/(jpg)|(png)|(jpeg)/i;for(let i=0;i<t.length;i++){s.test(t[i].type)||(e=this.$t("wrong_image_file_allowed_types")+": jpg, jpeg, png");const a=5e3;if(t[i].size>1024*a&&(e=this.$t("max_allowed_filesize")+" "+a+"Kb"),e)break}return e}}},l=r,c=s("2877"),d=s("0016"),p=s("27f9"),u=s("eebe"),m=s.n(u),h=Object(c["a"])(l,i,a,!1,null,null,null);e["a"]=h.exports;m()(h,"components",{QIcon:d["a"],QInput:p["a"]})},"5fb2":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-chip",{attrs:{color:t.bgColor,size:"0.8rem"}},[s("q-avatar",[t.avatar?s("img",{attrs:{src:"https://cdn.quasar.dev/img/avatar5.jpg"}}):t._e(),t.avatar?t._e():s("q-icon",{staticStyle:{"margin-top":"-3px"},attrs:{color:t.isPostAuthor?"white":"grey-8",name:"account_circle",size:"2.3rem"}})],1),s("strong",{style:{color:t.isPostAuthor?"white":"#363636"}},[t._v(t._s(t.name))])],1)},a=[],n={name:"Author",props:{isPostAuthor:{type:Boolean,default:!0},avatar:{type:String,default:null},name:{type:String,required:!0}},data(){return{}},computed:{bgColor(){return this.isPostAuthor?"green-5":"light-blue-1"}}},o=n,r=s("2877"),l=s("b047"),c=s("cb32"),d=s("0016"),p=s("eebe"),u=s.n(p),m=Object(r["a"])(o,i,a,!1,null,null,null);e["a"]=m.exports;u()(m,"components",{QChip:l["a"],QAvatar:c["a"],QIcon:d["a"]})},6357:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s("8847");class a{constructor(t){this.formModel=t,this.errors={error_message:null},this.formModel&&this.resetErrors()}setError(t,e){this.errors[t]=e[t]?e[t][0]:null}setErrors(t){const e=t.response.data.errors;if(e){for(const s in e)if(e.hasOwnProperty(s)){if("error_message"===s){this.errors.error_message=e[s];continue}this.errors[s]=e[s][0]||e[s]}}else{const e={invalid_grant:i["b"].messages[i["b"].locale].wrong_credentials,invalid_request:i["b"].messages[i["b"].locale].check_your_data},s=t.response.data.error;this.errors.error_message=e[s]||null}}resetFieldError(t,e){this.errors[t]&&(e?"string"===typeof this.errors[t]?this.errors[t]=null:this.errors[t][e]=null:this.errors[t]=null),this.errors.error_message=null}resetErrors(){for(const t in this.formModel)this.formModel.hasOwnProperty(t)&&(this.errors[t]=null)}}},"67f1":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment"},[s("div",{staticStyle:{"padding-left":"5px",color:"#5e5e5e"}},[s("div",{staticClass:"flex items-center q-pl-sm"},[s("rating",{attrs:{ratingable:t.comment,"ratingable-type":"comment"}}),s("author",{attrs:{name:t.comment.comment_author.login,"is-post-author":t.comment.comment_author.id===t.postAuthor.id,avatar:t.comment.comment_author.avatar}})],1),s("div",{staticStyle:{margin:"10px 0 20px 10px"}},[t._v("\n      "+t._s(t.comment.body)+"\n    ")])]),t.answers.length?s("div",{staticStyle:{"margin-left":"10px"},style:{borderLeft:t.levelBorderColor}},t._l(t.answers,(function(e,i){return s("comment",{key:e.id,attrs:{comment:e,level:t.level+1,"is-last":t.answers.length-1===i&&!t.isLast,"post-author":t.postAuthor}})})),1):t._e()])},a=[],n=(s("e6cf"),s("ddb0"),s("72cd")),o=s("d171"),r=s("5fb2"),l={name:"Comment",props:{comment:{type:Object,required:!0},level:{type:Number,required:!0},isLast:{type:Boolean,required:!0},postAuthor:{type:Object,required:!0}},components:{Author:r["a"],Rating:o["a"],Comment:()=>Promise.resolve().then(s.bind(null,"67f1"))},computed:{levelBorderColor(){const t=["#0d47a1","#1565c0","#1976d2","#1e88e5","#2196f3","#42a5f5","#64b5f6","#90caf9","#bbdefb","#e3f2fd"];return"1px solid "+t[(this.level+2)%10]}},data(){return{answers:[]}},created(){this.answers=n["a"].query().where((t=>"comments"===t.commentable_type_name&&t.commentable_id===this.comment.id)).withAll().get()}},c=l,d=(s("e5c0"),s("2877")),p=Object(d["a"])(c,i,a,!1,null,null,null);e["default"]=p.exports},"7cbd":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("e6cf");var i=s("77fc");class a{constructor(){if(a.instance)return a.instance;this.api=new i["a"],a.instance=this}incrementViews(t){return new Promise(((e,s)=>{this.api.post(`content/posts/increment-views/${t}`).then((t=>e(t))).catch((t=>s(t)))}))}fetchPost(t){return new Promise(((e,s)=>{this.api.get(`content/posts/${t}`).then((t=>{e(t)})).catch((t=>{s(t)}))}))}fetchPosts(t){return new Promise(((e,s)=>{this.api.get(`/content/posts?page=${t}`).then((t=>{e(t)})).catch((t=>{s(t)}))}))}store(t){return new Promise(((e,s)=>{this.api.post("/content/posts",t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>e(t))).catch((t=>{s(t)}))}))}update(t,e){return new Promise(((s,i)=>{this.api.post(`/content/posts/${e}`,t,{headers:{"Content-Type":"multipartddd/form-data"}}).then((t=>s(t))).catch((t=>{i(t)}))}))}}},8402:function(t,e,s){},8643:function(t,e,s){"use strict";s("e600")},"89d6":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("e6cf");var i=s("77fc");class a{constructor(){if(a.instance)return a.instance;this.api=new i["a"],a.instance=this}search(t){return new Promise(((e,s)=>{this.api.get(`/tags/search?title=${t}`).then((t=>e(t))).catch((t=>s(t)))}))}update(t,e){return new Promise(((s,i)=>{this.api.put(`admin/tags/${t}`,e).then((t=>s(t))).catch((t=>i(t)))}))}}},a010:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{error:t.errorMessage}},[s("q-select",{attrs:{label:t.$t("tags"),options:t.options,"use-input":"","use-chips":"",multiple:"","option-disable":"inactive","hide-dropdown-icon":"",outlined:"","input-debounce":"300","new-value-mode":"add-unique"},on:{input:function(e){return t.$emit("input",t.model)},filter:t.filterFn},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t.errorMessage?s("span",{staticStyle:{color:"red"}},[t._v(t._s(t.errorMessage))]):t._e()],1)},a=[],n=s("89d6"),o=s("4f9d"),r={name:"TagField",props:{errorMessage:{type:String,default:null},tags:{type:Array,default:null}},data(){return{options:[],tagApi:new n["a"],postEditor:new o["a"],fetching:!1}},computed:{model:{get(){return this.postEditor.formModel.tags},set(t){this.postEditor.formModel.tags=t}}},methods:{filterFn(t,e){if(""===t)return void e((()=>{}));const s=t.toLowerCase();this.options=[],this.tagApi.search(s).then((t=>{const s=t.data.data,i=[];s.forEach((t=>{i.push({label:t.title,value:t.id,inactive:"rejected"===t.status})})),e((()=>{this.options=i}))}))}}},l=r,c=s("2877"),d=s("ddd8"),p=s("eebe"),u=s.n(p),m=Object(c["a"])(l,i,a,!1,null,null,null);e["a"]=m.exports;u()(m,"components",{QSelect:d["a"]})},a31e:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10],"transition-show":"scale","transition-hide":"scale"}},[t._v("\n    "+t._s(t.tooltip)+"\n  ")]),s("q-icon",{staticClass:"q-mr-xs",attrs:{size:t.iconSize,name:t.iconName},on:{click:function(e){return t.$emit("click")}}})],1)},a=[],n={name:"TooltipIcon",props:{tooltip:{type:String,required:!0},iconName:{type:String,required:!0},iconSize:{type:String,default:"sm"}},data(){return{}}},o=n,r=s("2877"),l=s("05c0"),c=s("0016"),d=s("eebe"),p=s.n(d),u=Object(r["a"])(o,i,a,!1,null,null,null);e["a"]=u.exports;p()(u,"components",{QTooltip:l["a"],QIcon:c["a"]})},c29a:function(t,e,s){},d171:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-mr-md",attrs:{dusk:t.ratingableType+"-"+t.ratingable.id+"-rating"}},[t.isSubmitting?s("q-linear-progress",{staticStyle:{"margin-top":"-4px"},attrs:{indeterminate:""}}):t._e(),s("q-btn",{attrs:{round:"",size:"0.6rem",color:t.isMyVotePositive?"green-8":"grey-6",icon:"thumb_up"},on:{click:function(e){return t.vote("up")}}}),s("q-chip",{attrs:{color:t.rating.color,"text-color":0===t.rating.result?"black":"white"}},[t._v("\n    "+t._s(t.rating.result)+"\n    "),s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[t._v("\n      "+t._s(t.rating.positiveVotes)+" - "+t._s(t.rating.negativeVotes)+"\n    ")])],1),s("q-btn",{attrs:{round:"",color:!1===t.isMyVotePositive?"red-8":"grey-6",size:"0.6rem",icon:"thumb_down"},on:{click:function(e){return t.vote("down")}}})],1)},a=[],n=(s("e6cf"),s("77fc"));class o{constructor(){if(o.instance)return o.instance;this.api=new n["a"],o.instance=this}vote(t,e,s){return new Promise(((i,a)=>{this.api.post("/ratings/vote",{id:e,type:t,is_upvote:s}).then((t=>i(t))).catch((t=>a(t)))}))}}var r=s("e93d"),l=s("a256"),c=s("b65d"),d=s("891a"),p={name:"Rating",props:{ratingable:{type:Object,required:!0},ratingableType:{type:String,required:!0}},data(){return{isSubmitting:!1,ratingApi:new o,meCookies:new c["a"]}},computed:{me(){return d["a"].query().first()},ratingInstance(){return l["a"].query().where((t=>t.ratingable_id===this.ratingable.id&&t.ratingable_type_name===this.ratingableTypePlural)).first()},rating(){const t=this.ratingInstance,e=(null===t||void 0===t?void 0:t.positive_votes)||0,s=(null===t||void 0===t?void 0:t.negative_votes)||0,i=e-s;return{positiveVotes:e,negativeVotes:s,result:i,color:(()=>{let t="light-blue-1";return i>0?t="green-5":i<0&&(t="red-5"),t})()}},ratingableTypePlural(){return this.ratingableType+"s"},isMyVotePositive(){if(!this.me)return null;const t=r["a"].query().where((t=>t.user_id===this.me.id&&t.ratingable_id===this.ratingable.id&&t.ratingable_type_name===this.ratingableTypePlural)).first();return t?t.is_positive:null}},methods:{vote(t){if(!this.meCookies.get())return void this.$q.notify({message:this.$t("need_to_login_or_register"),position:"center",color:"negative"});if("up"===t&&this.isMyVotePositive||"down"===t&&!1===this.isMyVotePositive)return;const e=null!==this.isMyVotePositive;this.isSubmitting=!0,this.ratingApi.vote(this.ratingableType,this.ratingable.id,"up"===t).then((async s=>{this.isSubmitting=!1,await r["a"].insertOrUpdate({data:s.data}),await this.updateRating(t,e),this.$q.notify({message:this.$t("your_vote_is_accepted"),position:"center",color:"green"})})).catch((t=>{this.isSubmitting=!1,this.$q.notify({message:t.response.data.message,position:"center",color:"red"})}))},async updateRating(t,e){if(this.ratingInstance){let s=this.ratingInstance.positive_votes,i=this.ratingInstance.negative_votes;"up"===t?(s++,e&&i--):(i++,e&&s--),await l["a"].update({where:this.ratingInstance.id,data:{positive_votes:s,negative_votes:i}})}else await l["a"].insert({data:{ratingable_id:this.ratingable.id,ratingable_type_name:this.ratingableTypePlural,positive_votes:"up"===t?1:0,negative_votes:"down"===t?1:0}})}}},u=p,m=s("2877"),h=s("6b1d"),g=s("9c40"),f=s("b047"),_=s("05c0"),b=s("eebe"),v=s.n(b),y=Object(m["a"])(u,i,a,!1,null,null,null);e["a"]=y.exports;v()(y,"components",{QLinearProgress:h["a"],QBtn:g["a"],QChip:f["a"],QTooltip:_["a"]})},db11:function(t,e,s){},e118:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{error:t.errorMessage}},[s("q-input",{ref:"textField",attrs:{type:"textarea",autogrow:"",outlined:""},on:{input:t.input},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t.errorMessage?s("span",{staticStyle:{color:"red"}},[t._v(t._s(t.errorMessage))]):t._e()],1)},a=[],n=(s("5319"),s("4f9d")),o={name:"PostForm",props:{content:{type:String,required:""},order:{type:Number,required:!0},errorMessage:{type:[String]}},data(){return{model:"",postEditor:new n["a"]}},watch:{model(t){this.postEditor.updateSection(this.order,t)}},created(){this.model=this.replaceBr(this.content)},methods:{input(){this.$emit("input",this.model)},replaceBr(t){return t?t.replace(/<br>/g,""):""}}},r=o,l=s("2877"),c=s("27f9"),d=s("eebe"),p=s.n(d),u=Object(l["a"])(r,i,a,!1,null,null,null);e["a"]=u.exports;p()(u,"components",{QInput:c["a"]})},e5c0:function(t,e,s){"use strict";s("c29a")},e600:function(t,e,s){},e7bd:function(t,e,s){"use strict";s("db11")},f01b:function(t,e,s){"use strict";s("8402")},f9a5:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-card",{staticClass:"q-my-md",attrs:{id:"post-id-"+t.post.id,dusk:"post-"+t.post.id,bordered:!t.$q.platform.is.mobile,flat:""}},[s("q-card-section",{staticClass:"q-pb-none"},[s("author",{attrs:{name:t.post.user.login,avatar:t.post.user.avatar}}),t.isPostPage?s("q-item",{staticClass:"q-px-none",attrs:{dusk:"post-"+t.post.id+"-title"}},[s("q-item-section",{staticStyle:{"font-size":"1.2rem"}},[t._v("\n          "+t._s(t.post.title)+"\n        ")])],1):t._e(),t.isPostPage?t._e():s("q-item",{staticClass:"q-px-none",attrs:{dense:"",to:{name:"postPage",params:{id:t.post.id}},dusk:"post-"+t.post.id+"-title"}},[s("q-item-section",{staticStyle:{"font-size":"1.2rem"}},[t._v("\n          "+t._s(t.post.title)+"\n        ")])],1)],1),s("q-card-section",{ref:"postBody",class:{folded:!t.isExpanded}},t._l(t.post.content,(function(t){return s("post-"+t.type,{key:"postSection-"+t.order,tag:"component",attrs:{data:t}})})),1),!t.isExpanded&&t.isReady?s("q-card-section",{staticClass:"q-pt-none"},[s("div",{staticClass:"expander",on:{click:t.expand}},[t._v("\n        "+t._s(t.$t("expand"))+"\n      ")])]):t._e(),s("q-card-section",{attrs:{dusk:"post-"+t.post.id+"-info"}},[s("post-info",{attrs:{post:t.post}})],1),t.$q.platform.is.mobile?s("q-separator"):t._e()],1),t.isPostPage?s("comments",{attrs:{"post-id":t.post.id}}):t._e()],1)},a=[],n=(s("e6cf"),s("ddb0"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{color:"#757575"}},[s("div",{staticClass:"flex cursor-default items-center"},[s("rating",{attrs:{ratingable:t.post,"ratingable-type":"post"}}),s("div",{staticClass:"q-mr-md",attrs:{dusk:"post-"+t.post.id+"-info-views"}},[s("chip-info",{attrs:{label:t.post.views,icon:"visibility",tooltip:t.$t("views")}})],1),s("div",{staticClass:"q-mr-md",attrs:{dusk:"post-"+t.post.id+"-info-comments"}},[s("chip-info",{attrs:{label:t.post.comments,icon:"question_answer",tooltip:t.$t("comments")}})],1)],1),s("div",{staticClass:"q-mt-md flex",attrs:{dusk:"post-"+t.post.id+"-info-tags"}},t._l(t.post.tags,(function(t,e){return s("tag",{key:"tag"+e,attrs:{item:t}})})),1)])}),o=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-item",{staticClass:"t-wrapper",attrs:{to:{name:"search",query:{t:t.item.title.replace()}}}},[t.item.body?s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10],"transition-show":"scale","transition-hide":"scale","max-width":"300px"}},[s("span",{staticStyle:{"font-size":"1rem"}},[t._v(t._s(t.item.body))])]):t._e(),t._v("\n\n  "+t._s(t.item.title)+"\n")],1)},l=[],c={name:"Tag",props:{item:{type:Object,required:!0}}},d=c,p=(s("01a2"),s("2877")),u=s("66e5"),m=s("05c0"),h=s("eebe"),g=s.n(h),f=Object(p["a"])(d,r,l,!1,null,null,null),_=f.exports;g()(f,"components",{QItem:u["a"],QTooltip:m["a"]});var b=s("d171"),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-chip",{staticStyle:{"padding-left":"25px"},attrs:{color:t.bgColor,size:"1rem"}},[s("q-avatar",[s("q-icon",{attrs:{color:t.iconColor,name:t.icon,size:"1.5rem"}},[t.tooltip?s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10],"transition-show":"scale","transition-hide":"scale"}},[t._v("\n        "+t._s(t.tooltip)+"\n      ")]):t._e()],1)],1),s("span",{staticStyle:{"font-size":"0.9rem"}},[t._v(t._s(t.label))])],1)},y=[],w={name:"ChipInfo",props:{icon:{type:String,required:!0},label:{type:[String,Number],required:!0},tooltip:{type:String,default:null},bgColor:{type:String,default:"light-blue-1"},iconColor:{type:String,default:"grey-7"}},data(){return{}}},q=w,x=s("b047"),S=s("cb32"),I=s("0016"),$=Object(p["a"])(q,v,y,!1,null,null,null),P=$.exports;g()($,"components",{QChip:x["a"],QAvatar:S["a"],QIcon:I["a"],QTooltip:m["a"]});var C={name:"PostInfo",components:{ChipInfo:P,Tag:_,Rating:b["a"]},props:{post:{type:Object,required:!0}},data(){return{}}},E=C,k=(s("e7bd"),Object(p["a"])(E,n,o,!1,null,null,null)),M=k.exports,j=s("5e86"),A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{domProps:{innerHTML:t._s(t.data.body)}})},Q=[],T=s("f67e"),O={name:"PostText",props:{data:{type:T["a"],required:!0}}},F=O,z=Object(p["a"])(F,A,Q,!1,null,null,null),B=z.exports,L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{ref:"image",staticClass:"flex justify-center"},[s("img",{staticStyle:{"max-width":"100%"},style:{margin:"10px 0 15px 0",borderRadius:"5px"},attrs:{src:t.imageUrl,alt:"Зображення"}})]),t.data.title?s("div",{staticClass:"q-mb-lg text-center"},[t._v("\n    "+t._s(t.data.title)+"\n  ")]):t._e()])},W=[],R=s("ee7a"),D={name:"PostImage",props:{data:{type:R["a"],required:!0}},data(){return{isImageWiderThanWrapper:null}},computed:{isDesktop(){return this.$q.platform.is.desktop},imageUrl(){const t=this.$q.platform.is.desktop;return t?this.data.desktop_file_path||this.data.original_file_path:this.data.mobile_file_path||this.data.desktop_file_path||this.data.original_file_path},imageWidth(){const t=this.data.imageData;return this.isDesktop?this.data.desktop_file_path?t.desktop.width:t.original.width:this.data.mobile_file_path?t.mobile.width:t.original.width}},mounted(){this.isImageWiderThanWrapper=this.$refs.image.offsetWidth<this.data.width}},V=D,N=Object(p["a"])(V,L,W,!1,null,null,null),U=N.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",{attrs:{flat:"",bordered:!t.$q.platform.is.mobile}},[s("q-card-section",[t.isFetching?s("q-linear-progress",{staticStyle:{"margin-top":"-4px"},attrs:{indeterminate:""}}):t._e(),t._l(t.comments,(function(e,i){return s("comment",{key:e.id,attrs:{comment:e,level:1,"is-last":t.comments.length-1===i,"post-author":t.postAuthor}})}))],2)],1)},J=[],K=s("67f1"),G=s("77fc");class X{constructor(){if(X.instance)return X.instance;this.api=new G["a"],X.instance=this}async fetch(t,e){try{return await this.api.get("content/comments",{commentable_id:t,commentable_type:e})}catch(s){console.error(s)}}}var Y=s("72cd"),Z={name:"PostComments",components:{Comment:K["default"]},props:{postId:{type:Number,required:!0}},data(){return{api:new X,isFetching:!0}},computed:{comments(){return Y["a"].query().where((t=>"posts"===t.commentable_type_name&&t.commentable_id===this.postId)).withAll().get()},postAuthor(){return j["a"].query().with("user").find(this.postId).user}},async created(){const t=await this.api.fetch(this.postId,"post");await Y["a"].insert({data:t.data}),this.isFetching=!1},beforeDestroy(){Y["a"].deleteAll()}},tt=Z,et=s("f09f"),st=s("a370"),it=s("6b1d"),at=Object(p["a"])(tt,H,J,!1,null,null,null),nt=at.exports;g()(at,"components",{QCard:et["a"],QCardSection:st["a"],QLinearProgress:it["a"]});var ot=s("5fb2"),rt={name:"Post",components:{Comments:nt,PostImage:U,PostText:B,PostInfo:M,Author:ot["a"]},props:{post:{type:j["a"],required:!0},isPostPage:{type:Boolean,default:!1}},data(){return{isReady:!1}},computed:{isExpanded(){return!!this.isPostPage||!!this.postImagesLoaded&&this.post.is_expanded},postImagesLoaded(){return this.post.is_images_loaded},hasImages(){return!!this.post.post_images.length}},created(){this.hasImages&&!this.postImagesLoaded||(this.isReady=!0)},mounted(){this.hasImages||this.isExpanded||this.maybeExpandBody(),this.isPostPage||!this.hasImages||this.postImagesLoaded||this.imagesLoadedHandler()},methods:{isShortBody(){const t=this.$refs.postBody.$el.scrollHeight,e=.49*window.innerHeight;return t<e},maybeExpandBody(){this.isShortBody()&&this.expand(),this.updateImagesLoadingStatus(),removeEventListener("imagesUploaded",this.onImagesLoaded)},expand(){j["a"].update({where:this.post.id,data:{is_expanded:!0}})},async updateImagesLoadingStatus(){await j["a"].update({where:this.post.id,data:{is_images_loaded:!0}}),this.isReady=!0},imagesLoadedHandler(){const t=this.$refs.postBody.$el.getElementsByTagName("img");Promise.all(Array.from(t).filter((t=>!t.complete)).map((t=>new Promise((e=>{t.onload=t.onerror=e}))))).then((()=>{setTimeout((()=>{this.maybeExpandBody()}),10)}))}}},lt=rt,ct=(s("f01b"),s("4074")),dt=s("eb85"),pt=Object(p["a"])(lt,i,a,!1,null,null,null);e["a"]=pt.exports;g()(pt,"components",{QCard:et["a"],QCardSection:st["a"],QItem:u["a"],QItemSection:ct["a"],QSeparator:dt["a"]})}}]);
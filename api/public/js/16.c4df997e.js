(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{bcaf:function(t,o,e){"use strict";e.r(o);var i=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"row justify-center q-px-sm"},[e("div",{staticClass:"col-sm-12 col-xs-12 col-md-8 col-lg-6 col-xl-5 q-mt-md"},[e("q-card",{staticClass:"q-my-md",attrs:{flat:t.$q.platform.is.mobile}},[e("q-card-section",[e("q-input",{attrs:{outlined:"",dense:"",label:t.$t("title"),error:!!t.postEditor.validator.errors.title,"error-message":t.postEditor.validator.errors.title},on:{input:function(o){return t.postEditor.validator.resetFieldError("title")}},model:{value:t.postEditor.formModel.title,callback:function(o){t.$set(t.postEditor.formModel,"title",o)},expression:"postEditor.formModel.title"}}),e("div",{staticClass:"ap-body"},t._l(t.postEditor.formModel.sections,(function(o,i){return e("div",{key:"body-element"+o.order,staticClass:"q-mb-md"},[e("div",[e("icon-with-tooltip",{attrs:{tooltip:t.$t("delete_section"),icon:"delete"},on:{click:function(o){return t.postEditor.deleteSection(i)}}})],1),"youtube"===o.type?e("you-tube-field",{model:{value:o.content,callback:function(e){t.$set(o,"content",e)},expression:"section.content"}}):t._e(),"youtube"!==o.type?e(o.type+"-field",{ref:"editor["+o.order+"]",refInFor:!0,tag:"component",attrs:{content:o.content,order:o.order,"error-message":t.getSectionError(o.order)},on:{input:function(e){return t.postEditor.validator.resetFieldError("sections",o.order)}}}):t._e()],1)})),0),e("tag-field",{attrs:{"error-message":t.tagError},on:{input:t.updatePostTags}})],1),t.postEditor.validator.mainErrorMessage?e("q-card-section",{staticClass:"flex justify-center"},[e("div",{staticClass:"main-error-message"},[t._v("\n          "+t._s(t.postEditor.validator.mainErrorMessage)+"\n        ")])]):t._e(),t.postEditor.totalImages?e("q-card-section",{staticClass:"flex justify-center"},[e("div",{class:{"main-error-message":t.postEditor.totalImages>t.postEditor.totalImagesMax}},[t._v("\n          "+t._s(t.$t("total_number_of_images"))+":\n          "+t._s(t.postEditor.totalImages)+"\n          ("+t._s(t.$t("maximum"))+": "+t._s(t.postEditor.totalImagesMax)+")\n        ")])]):t._e(),e("q-card-section",{staticClass:"flex justify-between"},[e("q-inner-loading",{attrs:{showing:t.isBusy,color:"positive"}}),e("div",{staticClass:"inline-block"},[e("icon-with-tooltip",{attrs:{tooltip:t.$t("add_text"),color:"positive",disabled:t.isBusy,size:"xl",icon:"notes"},on:{click:function(o){return t.postEditor.addSection("text")}}}),e("icon-with-tooltip",{attrs:{tooltip:t.$t("add_image"),color:"positive",disabled:t.isBusy,size:"xl",icon:"image"},on:{click:function(o){return t.postEditor.addSection("image")}}}),e("icon-with-tooltip",{attrs:{tooltip:t.$t("add_youtube"),color:"positive",disabled:t.isBusy,size:"xl",icon:"smart_display"},on:{click:function(o){return t.postEditor.addSection("youtube")}}})],1),e("div",{staticClass:"inline-block"},[t.canBeViewed?e("icon-with-tooltip",{attrs:{tooltip:t.$t("preview"),color:"positive",disabled:t.isBusy,size:"xl",icon:"pageview"},on:{click:function(o){return t.$router.push({name:"postPage",params:{id:t.postId}})}}}):t._e(),e("icon-with-tooltip",{attrs:{tooltip:t.$t("cancel"),color:"negative",disabled:t.isBusy,size:"xl",icon:"cancel"},on:{click:t.goBack}}),e("icon-with-tooltip",{attrs:{tooltip:t.$t("save"),color:"positive",disabled:t.isBusy,size:"xl",icon:"check_circle"},on:{click:function(o){return t.saveOrUpdate()}}})],1)],1)],1)],1)])},s=[],r=(e("e6cf"),e("5440")),a=e("e118"),n=e("a010"),d=e("a31e"),l=e("51d9"),c=e("4f9d"),p=e("5e86"),u=e("7cbd"),m=e("5899c"),f={name:"AddPost",components:{TooltipIcon:d["a"],ImageField:r["a"],TextField:a["a"],IconWithTooltip:l["a"],TagField:n["a"],YouTubeField:m["a"]},data(){return{postEditor:new c["a"],postApi:new u["a"],isBusy:!1,canBeViewed:!1}},computed:{sectionsErrors(){return this.postEditor.validator.errors.sections},isEditing(){return"editPost"===this.$route.name},postId(){return this.$route.params.id},post(){return p["a"].query().withAll().find(this.postId)},tagError(){return this.postEditor.validator.errors.tags||null}},created(){this.postEditor.resetFormModel(),setTimeout((()=>{this.postEditor.addSection("text")}),10)},beforeDestroy(){this.postEditor.resetFormModel(),this.postEditor.validator.resetErrors()},methods:{goBack(){window.history.back()},fetchPost(){return new Promise(((t,o)=>{this.isBusy=!0,this.postApi.fetchPost(this.postId).then((o=>{this.isBusy=!1,t(o)})).catch((()=>{this.isBusy=!1}))}))},getSectionError(t){const o=this.postEditor.validator.errors.sections;return o&&"string"!==typeof o?o[t]:null},saveOrUpdate(){this.isBusy=!0,this.postEditor.saveOrUpdate(this.postId).then((t=>{this.isBusy=!1;const o=t.data.data,e=o.id;this.isEditing||(p["a"].create({data:t.data.data}),this.$router.push({name:"editPost",params:{id:e}})),this.$q.notify({message:this.$t("success"),position:"center",color:"positive"})})).catch((()=>{this.isBusy=!1}))},updatePostTags(){this.postEditor.validator.resetFieldError("tags")},crtlSHandler(t){document.addEventListener("keydown",(t=>{t.ctrlKey&&"s"===t.key&&(t.preventDefault(),console.log("CTRL + S"))}))}}},h=f,E=e("2877"),g=e("f09f"),v=e("a370"),y=e("27f9"),b=e("74f7"),w=e("eebe"),_=e.n(w),x=Object(E["a"])(h,i,s,!1,null,null,null);o["default"]=x.exports;_()(x,"components",{QCard:g["a"],QCardSection:v["a"],QInput:y["a"],QInnerLoading:b["a"]})}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"308d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-mt-lg"},[a("avatar-editor",{model:{value:t.isAvatarEditorOpened,callback:function(e){t.isAvatarEditorOpened=e},expression:"isAvatarEditorOpened"}}),a("stats",{attrs:{"user-id":t.me.id},on:{fetched:t.fetchContentStats,avatarClicked:function(e){t.isAvatarEditorOpened=!0}}}),t.isFetchingStats&&t.statsFetched?a("q-linear-progress",{staticStyle:{position:"relative",top:"4px"},attrs:{indeterminate:""}}):t._e(),t.isFetchingStats?t._e():a("div",{staticClass:"profile"},[a("q-tabs",{staticClass:"q-mt-xl text-grey-8",attrs:{"inline-label":"","outside-arrows":"","mobile-arrows":"","no-caps":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{disable:!t.contentStats.posts.total,name:"posts",icon:"mms",label:t.$t("posts")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v("\n          "+t._s(t.contentStats.posts.total)+"\n        ")])],1),a("q-tab",{attrs:{disable:!t.contentStats.total_comments,name:"comments",icon:"mode_comment",label:t.$t("comments")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v("\n          "+t._s(t.contentStats.total_comments)+"\n        ")])],1),a("q-tab",{attrs:{disable:!t.contentStats.total_answers,name:"answers",icon:"forum",label:t.$t("answers")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v("\n          "+t._s(t.contentStats.total_answers)+"\n        ")])],1)],1),a("q-card",{staticClass:"q-mb-lg",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"posts"}},[a("posts-tabs",{attrs:{"total-posts":t.contentStats.posts}})],1),a("q-tab-panel",{attrs:{name:"comments"}},[a("comments-tab")],1),a("q-tab-panel",{attrs:{name:"answers"}},[a("answer-tab")],1)],1)],1)],1)],1)],1)},o=[],n=(a("e6cf"),a("deb1")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post-tabs"},[a("q-tabs",{staticClass:"text-grey-8",attrs:{"inline-label":"","outside-arrows":"","mobile-arrows":"","no-caps":"",dense:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{disable:!t.totalPosts.approved,name:"approved",icon:"mms",label:t.$t("published")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v(t._s(t.totalPosts.approved||0))])],1),a("q-tab",{attrs:{disable:!t.totalPosts.pending,name:"pending",icon:"mark_chat_unread",label:t.$t("pending")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v(t._s(t.totalPosts.pending||0))])],1),a("q-tab",{attrs:{disable:!t.totalPosts.draft,name:"draft",icon:"chat_bubble_outline",label:t.$t("drafts")}},[a("q-badge",{staticClass:"q-ml-sm",attrs:{color:"green"}},[t._v(t._s(t.totalPosts.draft||0))])],1)],1),a("q-separator"),a("data-table",{attrs:{columns:t.columns,url:t.url,"row-key":"post","use-body":""},scopedSlots:t._u([{key:"table",fn:function(e){return[a("q-tr",[a("q-td",[a("q-item",{attrs:{to:t.getPostLink(e.props.row),target:"_blank"}},[a("q-item-section",[a("icon-with-tooltip",{attrs:{tooltip:t.$t("preview"),color:"positive",size:"sm",icon:"pageview"}})],1)],1),"draft"===e.props.row.status?a("q-item",{staticClass:"q-ml-sm",attrs:{to:{name:"editPost",params:{id:e.props.row.id}},target:"_blank"}},[a("q-item-section",[a("icon-with-tooltip",{attrs:{tooltip:t.$t("to_edit"),color:"positive",size:"sm",icon:"edit_note"}})],1)],1):t._e()],1),a("q-td",[t._v("\n          "+t._s(t.getTitle(e.props.row.title))+"\n        ")]),"approved"===t.tab?[a("q-td",{staticClass:"text-right"},[e.props.row.rating?[a("strong",[t._v(t._s(e.props.row.rating.positive_votes-e.props.row.rating.negative_votes))]),t._v("\n              (\n              "+t._s(e.props.row.rating.positive_votes)+" -\n              "+t._s(e.props.row.rating.negative_votes)+"\n              )\n            ")]:t._e(),e.props.row.rating?t._e():a("span",[t._v("0")])],2),a("q-td",{staticClass:"text-right"},[t._v("\n            "+t._s(e.props.row.comments)+"\n          ")])]:t._e()],2)]}}])})],1)},i=[],l=a("891a"),p=a("30b7"),c=a("51d9"),d={name:"PostsTabs",components:{DataTable:p["a"],IconWithTooltip:c["a"]},props:{totalPosts:{type:Object,required:!0}},data(){return{me:l["a"].query().first(),tab:"approved",title:"Posts"}},computed:{columns(){const t=[{required:!0,label:this.$t("actions"),align:"left",sortable:!1},{required:!0,label:this.$t("title"),align:"left",sortable:!1}];return"approved"===this.tab&&(t.push({required:!0,label:this.$t("rating"),align:"right",sortable:!1}),t.push({required:!0,label:this.$t("total_comments"),align:"right",sortable:!1})),t},url(){return"profile/posts?status="+this.tab}},methods:{getTitle(t){let e=t.substring(0,30);return t.length>30&&(e+="..."),e},getPostLink(t){const e="approved"===this.tab?"postView":"postPreview";return{name:e,params:{id:t.id}}}}},m=d,b=(a("9d99"),a("2877")),u=a("429b"),g=a("7460"),h=a("58a81"),v=a("eb85"),_=a("bd08"),q=a("db86"),w=a("66e5"),f=a("4074"),$=a("eebe"),y=a.n($),S=Object(b["a"])(m,r,i,!1,null,null,null),T=S.exports;y()(S,"components",{QTabs:u["a"],QTab:g["a"],QBadge:h["a"],QSeparator:v["a"],QTr:_["a"],QTd:q["a"],QItem:w["a"],QItemSection:f["a"]});var Q=a("77fc");class C{constructor(){if(C.instance)return C.instance;this.api=new Q["a"],C.instance=this}fetchContentStats(){return new Promise(((t,e)=>{this.api.get("profile/content-stats",null,null,!0).then((e=>t(e))).catch((t=>e(t)))}))}uploadAvatar(t){const e=new FormData;return e.append("avatar",t),new Promise(((t,a)=>{this.api.post("profile/avatar",e,null,null,!0).then((e=>t(e))).catch((t=>a(t)))}))}}var O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("data-table",{attrs:{"no-top":"",url:"profile/comments",columns:t.columns,"row-key":"comment","use-body":""},scopedSlots:t._u([{key:"table",fn:function(e){return[a("q-tr",[a("q-td",[a("q-item",{attrs:{to:{name:"postView",params:{id:e.props.row.post_id},query:{c:e.props.row.id}},target:"_blank"}},[a("q-item-section",[a("icon-with-tooltip",{attrs:{tooltip:t.$t("preview"),color:"positive",size:"sm",icon:"pageview"}})],1)],1)],1),a("q-td",[a("icon-with-tooltip",{attrs:{size:"sm",icon:t.getReplyOnIcon(e.props.row.commentable_type_name),tooltip:t.getReplyOnTooltip(e.props.row.commentable_type_name),color:"grey-8"}})],1),a("q-td",[t._v("\n        "+t._s(t.getShortString(e.props.row.body,30))+"\n      ")]),a("q-td",[t._v("\n        "+t._s(t.getShortString(e.props.row.post.title,30))+"\n      ")]),a("q-td",[t._v("\n        "+t._s(t.getRating(e.props.row.rating))+"\n      ")]),a("q-td",[t._v("\n        "+t._s(e.props.row.clean_answers_count)+"\n      ")])],1)]}}])})},k=[],P={name:"CommentsTab",components:{DataTable:p["a"],IconWithTooltip:c["a"]},data(){return{columns:[{required:!0,label:this.$t("actions"),align:"left",sortable:!1},{required:!0,label:this.$t("reply_on"),align:"left",sortable:!1},{required:!0,label:this.$t("comment"),align:"left",sortable:!1},{required:!0,label:this.$t("post"),align:"left",sortable:!1},{required:!0,label:this.$t("rating"),align:"left",sortable:!1},{required:!0,label:this.$t("answers"),align:"left",sortable:!1}]}},methods:{getReplyOnIcon(t){return"posts"===t?"mms":"mode_comment"},getReplyOnTooltip(t){return"posts"===t?this.$t("post"):this.$t("comment")},getShortString(t,e){let a=t.substring(0,30);return t.length>e&&(a+="..."),a},getRating(t){const e=t.positive_votes,a=t.negative_votes,s=e-a;return`${s} (${e} - ${a})`}}},x=P,I=Object(b["a"])(x,O,k,!1,null,null,null),R=I.exports;y()(I,"components",{QTr:_["a"],QTd:q["a"],QItem:w["a"],QItemSection:f["a"]});var A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("data-table",{attrs:{"no-top":"",url:"profile/answers",columns:t.columns,"row-key":"comment","use-body":""},scopedSlots:t._u([{key:"table",fn:function(e){return[a("q-tr",[a("q-td",[a("q-item",{attrs:{to:{name:"postView",params:{id:e.props.row.post_id},query:{c:e.props.row.id}},target:"_blank"}},[a("q-item-section",[a("icon-with-tooltip",{attrs:{tooltip:t.$t("preview"),color:"positive",size:"sm",icon:"pageview"}})],1)],1)],1),a("q-td",[a("icon-with-tooltip",{attrs:{size:"sm",icon:t.getReplyOnIcon(e.props.row.commentable_type_name),tooltip:t.getReplyOnTooltip(e.props.row.commentable_type_name),color:"grey-8"}})],1),a("q-td",[t._v("\n        "+t._s(t.getShortString(e.props.row.body,30))+"\n      ")]),a("q-td",[a("q-item",[a("q-item-section",[t._v("\n            "+t._s(e.props.row.user.login)+"\n          ")])],1)],1),a("q-td",[t._v("\n        "+t._s(t.getShortString(e.props.row.post.title,30))+"\n      ")]),a("q-td",[t._v("\n        "+t._s(t.getRating(e.props.row.rating))+"\n      ")]),a("q-td",[t._v("\n        "+t._s(e.props.row.clean_answers_count)+"\n      ")])],1)]}}])})},E=[],j={name:"AnswerTab",components:{DataTable:p["a"],IconWithTooltip:c["a"]},data(){return{columns:[{required:!0,label:this.$t("actions"),align:"left",sortable:!1},{required:!0,label:this.$t("reply_on"),align:"left",sortable:!1},{required:!0,label:this.$t("answer"),align:"left",sortable:!1},{required:!0,label:this.$t("author"),align:"left",sortable:!1},{required:!0,label:this.$t("post"),align:"left",sortable:!1},{required:!0,label:this.$t("rating"),align:"left",sortable:!1}]}},methods:{getReplyOnIcon(t){return"posts"===t?"mms":"mode_comment"},getReplyOnTooltip(t){return"posts"===t?this.$t("post"):this.$t("comment")},getShortString(t,e){let a=t.substring(0,30);return t.length>e&&(a+="..."),a},getRating(t){const e=t.positive_votes,a=t.negative_votes,s=e-a;return`${s} (${e} - ${a})`}}},F=j,U=Object(b["a"])(F,A,E,!1,null,null,null),z=U.exports;y()(U,"components",{QTr:_["a"],QTd:q["a"],QItem:w["a"],QItemSection:f["a"]});var D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[a("q-card",[a("q-card-section",[a("vue-avatar",{ref:"editor",attrs:{width:300,height:300,"border-radius":150,border:0,scale:t.scale}}),a("q-slider",{attrs:{min:1,max:3,step:.02},model:{value:t.scale,callback:function(e){t.scale=e},expression:"scale"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{"no-caps":"",disable:t.isUploading,label:t.$t("cancel")}}),a("q-btn",{attrs:{"no-caps":"",disable:t.isUploading,loading:t.isUploading,label:t.$t("save"),color:"primary"},on:{click:t.upload}})],1)],1)],1)},L=[],B=(a("5319"),a("2b3d"),a("ddb0"),a("9657")),J={name:"AvatarEditor",components:{VueAvatar:B["a"]},props:{value:{type:Boolean,required:!0}},data(){return{scale:1,isUploading:!1,api:new C}},computed:{isOpen:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{async upload(){this.isUploading=!0;const t=this.$refs.editor.getImageScaled(),e=await(await fetch(t.toDataURL())).blob(),a=new File([e],"avatar.png",{type:e.type});this.convertPngToJpeg(a).then((t=>{this.api.uploadAvatar(t).then((t=>{const e=t.data,a=l["a"].query().first();l["a"].update({where:a.id,data:{avatar:e.avatar}}),this.isUploading=!1,this.isOpen=!1}))}))},convertPngToJpeg(t){return new Promise(((e,a)=>{const s=document.createElement("canvas"),o=s.getContext("2d"),n=new Image;n.onload=function(){s.width=n.width,s.height=n.height,o.drawImage(n,0,0),s.toBlob((a=>{const s=new File([a],t.name.replace(".png",".jpg"),{type:"image/jpeg"});e(s)}),"image/jpeg",.9)},n.onerror=a,n.src=URL.createObjectURL(t)}))}}},V=J,W=a("24e8"),N=a("f09f"),G=a("a370"),H=a("c1d0"),K=a("4b7e"),M=a("9c40"),X=a("7f67"),Y=Object(b["a"])(V,D,L,!1,null,null,null),Z=Y.exports;y()(Y,"components",{QDialog:W["a"],QCard:N["a"],QCardSection:G["a"],QSlider:H["a"],QCardActions:K["a"],QBtn:M["a"]}),y()(Y,"directives",{ClosePopup:X["a"]});var tt={name:"Account",components:{AvatarEditor:Z,AnswerTab:z,CommentsTab:R,Stats:n["a"],PostsTabs:T},data(){return{me:l["a"].query().first(),tab:"posts",isFetchingStats:!0,api:new C,contentStats:null,statsFetched:!1,isAvatarEditorOpened:!1}},methods:{async fetchContentStats(){this.statsFetched=!0;const t=await this.api.fetchContentStats();this.isFetchingStats=!1,this.contentStats=t.data}}},et=tt,at=(a("4f4a"),a("6b1d")),st=a("adad"),ot=a("823b"),nt=Object(b["a"])(et,s,o,!1,null,null,null);e["default"]=nt.exports;y()(nt,"components",{QLinearProgress:at["a"],QTabs:u["a"],QTab:g["a"],QBadge:h["a"],QCard:N["a"],QCardSection:G["a"],QTabPanels:st["a"],QTabPanel:ot["a"],QItem:w["a"]})},"4f4a":function(t,e,a){"use strict";a("8fce")},"61ec":function(t,e,a){},"8fce":function(t,e,a){},"9d99":function(t,e,a){"use strict";a("61ec")}}]);
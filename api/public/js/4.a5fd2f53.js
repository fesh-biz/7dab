(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"01a2":function(t,e,s){"use strict";s("247c")},"0d8b":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-center q-px-sm"},[s("div",{staticClass:"col-sm-12 col-xs-12 col-md-8 col-lg-6 col-xl-5"},[t.fetching.posts?s("q-linear-progress",{class:{"q-mt-md":!t.$q.platform.is.mobile},attrs:{indeterminate:""}}):t._e(),t._l(t.posts,(function(t,e){return s("post",{key:"post"+e,attrs:{post:t}})})),t.isLastFetched?s("q-banner",{staticClass:"text-center",attrs:{dusk:"main-no-more-posts",rounded:""}},[t._v("\n      "+t._s(t.$t("there_is_no_new_posts"))+"\n    ")]):t._e(),t.fetching.posts&&t.posts.length?s("q-linear-progress",{staticClass:"q-mb-xl",attrs:{dusk:"main-new-posts-loading",indeterminate:""}}):t._e()],2)])},o=[],i=(s("e6cf"),s("5e86")),n=s("f9a5"),r=s("7cbd");function d(t){const e=document.documentElement.offsetHeight,s=window.innerHeight,a=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);return e<=s+a+(t||0)}var c=s("f146"),l={name:"FeedMain",components:{Post:n["a"]},data(){return{fetching:{posts:!1},isLastFetched:!1,currentPage:0,postApi:new r["a"]}},computed:{posts(){return i["a"].query().withAll().orderBy("id","desc").all()}},async created(){this.posts.length<2&&(await i["a"].deleteAll(),this.fetchPosts(!0))},mounted(){window.addEventListener("scroll",this.maybeFetchNextPosts)},methods:{scrollToPost(t){const e=document.getElementById(t);e?setTimeout((()=>{e.scrollIntoView({behavior:"smooth"})}),100):setTimeout((()=>{this.scrollToPost(t)}),100)},maybeFetchNextPosts(){this.fetching.posts||!d(500)||this.isLastFetched||this.fetchPosts()},fetchPosts(t){this.fetching.posts=!0,this.postApi.fetchPosts(++this.currentPage).then((async e=>{t?await i["a"].create({data:e.data.data}):await i["a"].insert({data:e.data.data}),this.isLastFetched=e.data.meta.is_last,this.$nextTick((()=>{this.fetching.posts=!1,c["a"].emitImagesUploaded()}))})).catch((()=>{this.fetching.posts=!1}))}},beforeDestroy(){window.removeEventListener("scroll",this.maybeFetchNextPosts)}},p=l,m=s("2877"),u=s("6b1d"),h=s("54e1"),f=s("eebe"),g=s.n(f),_=Object(m["a"])(p,a,o,!1,null,null,null);e["default"]=_.exports;g()(_,"components",{QLinearProgress:u["a"],QBanner:h["a"]})},"247c":function(t,e,s){},"7cbd":function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));s("e6cf");var a=s("77fc");class o{constructor(){if(o.instance)return o.instance;this.api=new a["a"],o.instance=this}fetchPost(t){return new Promise(((e,s)=>{this.api.get(`content/posts/${t}`).then((t=>{e(t)})).catch((t=>{s(t)}))}))}fetchPosts(t){return new Promise(((e,s)=>{this.api.get(`/content/posts?page=${t}`).then((t=>{e(t)})).catch((t=>{s(t)}))}))}store(t){return new Promise(((e,s)=>{this.api.post("/content/posts",t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>e(t))).catch((t=>{s(t)}))}))}update(t,e){return new Promise(((s,a)=>{this.api.put(`/content/posts/${e}`,t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>s(t))).catch((t=>{a(t)}))}))}}},8402:function(t,e,s){},a31e:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10],"transition-show":"scale","transition-hide":"scale"}},[t._v("\n    "+t._s(t.tooltip)+"\n  ")]),s("q-icon",{staticClass:"q-mr-xs",attrs:{size:t.iconSize,name:t.iconName},on:{click:function(e){return t.$emit("click")}}})],1)},o=[],i={name:"TooltipIcon",props:{tooltip:{type:String,required:!0},iconName:{type:String,required:!0},iconSize:{type:String,default:"sm"}},data(){return{}}},n=i,r=s("2877"),d=s("05c0"),c=s("0016"),l=s("eebe"),p=s.n(l),m=Object(r["a"])(n,a,o,!1,null,null,null);e["a"]=m.exports;p()(m,"components",{QTooltip:d["a"],QIcon:c["a"]})},f01b:function(t,e,s){"use strict";s("8402")},f146:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("e6cf"),s("ddb0");class a{static emitImagesUploaded(){const t=new Event("imagesUploaded"),e=document.images;e.length?Promise.all(Array.from(e).filter((t=>!t.complete)).map((t=>new Promise((e=>{t.onload=t.onerror=e}))))).then((()=>{setTimeout((()=>{dispatchEvent(t)}),100)})):dispatchEvent(t)}}},f9a5:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",{staticClass:"q-my-md",attrs:{id:"post-id-"+t.post.id,dusk:"post-"+t.post.id,flat:t.$q.platform.is.mobile}},[s("q-card-section",{staticClass:"q-pb-none"},[s("div",{attrs:{dusk:"post-"+t.post.id+"-author"}},[t._v("\n      "+t._s(t.post.user.login)+"\n    ")]),t.isPostPage?s("q-item",{staticClass:"font-lobster q-px-none",attrs:{dusk:"post-"+t.post.id+"-title"}},[s("q-item-section",{staticStyle:{"font-size":"1.2rem"}},[t._v("\n        "+t._s(t.post.title)+"\n      ")])],1):t._e(),t.isPostPage?t._e():s("q-item",{staticClass:"font-lobster q-px-none",attrs:{dense:"",to:{name:"postPage",params:{id:t.post.id}},dusk:"post-"+t.post.id+"-title"}},[s("q-item-section",{staticStyle:{"font-size":"1.2rem"}},[t._v("\n        "+t._s(t.post.title)+"\n      ")])],1)],1),s("q-card-section",{ref:"postBody",class:{folded:!t.isExpanded}},t._l(t.post.content,(function(t){return s("post-"+t.type,{key:"postSection-"+t.order,tag:"component",attrs:{data:t}})})),1),!t.isExpanded&&t.isReady?s("q-card-section",{staticClass:"q-pt-none"},[s("div",{staticClass:"expander",staticStyle:{"border-radius":"0px 0px 10px 10px"},on:{click:t.expand}},[t._v("\n      "+t._s(t.$t("expand"))+"\n    ")])]):t._e(),s("q-card-section",{attrs:{dusk:"post-"+t.post.id+"-info"}},[s("post-info",{attrs:{post:t.post}})],1),t.$q.platform.is.mobile?s("q-separator"):t._e()],1)},o=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{color:"#757575"}},[t._e(),s("div",{staticClass:"q-mt-md flex",attrs:{dusk:"post-"+t.post.id+"-info-tags"}},t._l(t.post.tags,(function(t,e){return s("tag",{key:"tag"+e,attrs:{item:t}})})),1)])},n=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-item",{staticClass:"t-wrapper",attrs:{to:{name:"search",query:{t:t.item.title.replace()}}}},[t.item.body?s("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10],"transition-show":"scale","transition-hide":"scale","max-width":"300px"}},[s("span",{staticStyle:{"font-size":"1rem"}},[t._v(t._s(t.item.body))])]):t._e(),t._v("\n\n  "+t._s(t.item.title)+"\n")],1)},d=[],c={name:"Tag",props:{item:{type:Object,required:!0}}},l=c,p=(s("01a2"),s("2877")),m=s("66e5"),u=s("05c0"),h=s("eebe"),f=s.n(h),g=Object(p["a"])(l,r,d,!1,null,null,null),_=g.exports;f()(g,"components",{QItem:m["a"],QTooltip:u["a"]});var b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex"},[s("tooltip-icon",{attrs:{"icon-size":"xs","icon-name":t.icon,tooltip:t.tooltipLabel}}),t._v(" "+t._s(t.amount)+"\n")],1)},y=[],w=s("a31e"),x={name:"PostInfoIcon",components:{TooltipIcon:w["a"]},props:{amount:{type:Number,required:!0},tooltipLabel:{type:String,required:!0},icon:{type:String,required:!0}},data(){return{}}},v=x,q=Object(p["a"])(v,b,y,!1,null,null,null),P=q.exports,I={name:"PostInfo",components:{PostInfoIcon:P,Tag:_},props:{post:{type:Object,required:!0}}},k=I,$=Object(p["a"])(k,i,n,!1,null,null,null),E=$.exports,S=s("5e86"),T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{domProps:{innerHTML:t._s(t.data.body)}})},C=[],L=s("f67e"),j={name:"PostText",props:{data:{type:L["a"],required:!0}}},O=j,Q=Object(p["a"])(O,T,C,!1,null,null,null),B=Q.exports,F=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{ref:"image",staticClass:"flex justify-center"},[s("img",{staticStyle:{"max-width":"100%"},style:{margin:"10px 0 15px 0",borderRadius:"5px"},attrs:{src:t.imageUrl,alt:"Зображення"}})]),t.data.title?s("div",{staticClass:"font-lobster q-mb-lg text-center"},[t._v("\n    "+t._s(t.data.title)+"\n  ")]):t._e()])},N=[],z=s("ee7a"),U={name:"PostImage",props:{data:{type:z["a"],required:!0}},data(){return{isImageWiderThanWrapper:null}},computed:{isDesktop(){return this.$q.platform.is.desktop},imageUrl(){const t=this.$q.platform.is.desktop;return t?this.data.desktop_file_path||this.data.original_file_path:this.data.mobile_file_path||this.data.desktop_file_path||this.data.original_file_path},imageWidth(){const t=this.data.imageData;return this.isDesktop?this.data.desktop_file_path?t.desktop.width:t.original.width:this.data.mobile_file_path?t.mobile.width:t.original.width}},mounted(){this.isImageWiderThanWrapper=this.$refs.image.offsetWidth<this.data.width}},W=U,A=Object(p["a"])(W,F,N,!1,null,null,null),H=A.exports,R=s("f146"),D={name:"Post",components:{PostImage:H,PostText:B,PostInfo:E},props:{post:{type:S["a"],required:!0},isPostPage:{type:Boolean,default:!1}},data(){return{documentState:new R["a"],isReady:!1}},computed:{isExpanded(){return!!this.isPostPage||!!this.postImagesLoaded&&this.post.is_expanded},postImagesLoaded(){return this.post.is_images_loaded}},created(){this.hasNotImages()&&(this.isReady=!0)},mounted(){addEventListener("imagesUploaded",this.onImagesLoaded)},methods:{hasNotImages(){return!!this.post.post_images.length},isShortBody(){const t=this.$refs.postBody.$el.clientHeight,e=.7*window.innerHeight;return t<e},onImagesLoaded(){this.isShortBody()&&this.expand(),this.updateImagesLoadingStatus(),this.isReady=!0,removeEventListener("imagesUploaded",this.onImagesLoaded)},expand(){S["a"].update({where:this.post.id,data:{is_expanded:!0}})},updateImagesLoadingStatus(){S["a"].update({where:this.post.id,data:{is_images_loaded:!0}})}}},J=D,M=(s("f01b"),s("f09f")),Y=s("a370"),V=s("4074"),G=s("eb85"),K=Object(p["a"])(J,a,o,!1,null,null,null);e["a"]=K.exports;f()(K,"components",{QCard:M["a"],QCardSection:Y["a"],QItem:m["a"],QItemSection:V["a"],QSeparator:G["a"]})}}]);
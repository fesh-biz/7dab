(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{bcaf:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-card",{staticClass:"q-my-md",attrs:{flat:t.$q.platform.is.mobile}},[o("q-card-section",[o("q-input",{attrs:{outlined:"",dense:"",label:t.$t("title"),error:!!t.postEditor.validator.errors.title,"error-message":t.postEditor.validator.errors.title},on:{input:function(e){return t.postEditor.validator.resetFieldError("title")}},model:{value:t.postEditor.formModel.title,callback:function(e){t.$set(t.postEditor.formModel,"title",e)},expression:"postEditor.formModel.title"}}),o("div",{staticClass:"ap-body"},t._l(t.postEditor.formModel.sections,(function(e,i){return o("div",{key:"body-element"+e.order,staticClass:"q-mb-md"},[o("div",[o("icon-with-tooltip",{attrs:{tooltip:t.$t("delete_section"),icon:"delete"},on:{click:function(e){return t.postEditor.deleteSection(i)}}})],1),"youtube"===e.type?o("you-tube-field",{model:{value:e.content,callback:function(o){t.$set(e,"content",o)},expression:"section.content"}}):t._e(),"youtube"!==e.type?o(e.type+"-field",{ref:"editor["+e.order+"]",refInFor:!0,tag:"component",attrs:{content:e.content,order:e.order,"error-message":t.getSectionError(e.order)},on:{input:function(o){return t.postEditor.validator.resetFieldError("sections",e.order)}}}):t._e()],1)})),0),o("tag-field",{attrs:{"error-message":t.tagError},on:{input:t.updatePostTags}})],1),t.postEditor.validator.mainErrorMessage?o("q-card-section",{staticClass:"flex justify-center"},[o("div",{staticClass:"main-error-message"},[t._v("\n      "+t._s(t.postEditor.validator.mainErrorMessage)+"\n    ")])]):t._e(),t.postEditor.totalImages?o("q-card-section",{staticClass:"flex justify-center"},[o("div",{class:{"main-error-message":t.postEditor.totalImages>t.postEditor.totalImagesMax}},[t._v("\n      "+t._s(t.$t("total_number_of_images"))+":\n      "+t._s(t.postEditor.totalImages)+"\n      ("+t._s(t.$t("maximum"))+": "+t._s(t.postEditor.totalImagesMax)+")\n    ")])]):t._e(),1===t.me.id?o("q-card-section",[o("select-fake-user",{model:{value:t.postEditor.fake_user_id,callback:function(e){t.$set(t.postEditor,"fake_user_id",e)},expression:"postEditor.fake_user_id"}})],1):t._e(),o("q-card-section",{staticClass:"flex justify-between"},[o("q-inner-loading",{attrs:{showing:t.isBusy,color:"positive"}}),o("div",{staticClass:"inline-block"},[o("icon-with-tooltip",{attrs:{tooltip:t.$t("add_text"),color:"positive",disabled:t.isBusy,size:"xl",icon:"notes"},on:{click:function(e){return t.postEditor.addSection("text")}}}),o("icon-with-tooltip",{attrs:{tooltip:t.$t("add_image"),color:"positive",disabled:t.isBusy,size:"xl",icon:"image"},on:{click:function(e){return t.postEditor.addSection("image")}}}),o("icon-with-tooltip",{attrs:{tooltip:t.$t("add_youtube"),color:"positive",disabled:t.isBusy,size:"xl",icon:"smart_display"},on:{click:function(e){return t.postEditor.addSection("youtube")}}})],1),o("div",{staticClass:"inline-block"},[t.canBeViewed?o("icon-with-tooltip",{attrs:{tooltip:t.$t("preview"),color:"positive",disabled:t.isBusy,size:"xl",icon:"pageview"},on:{click:function(e){return t.$router.push({name:"postPage",params:{id:t.postId}})}}}):t._e(),o("icon-with-tooltip",{attrs:{tooltip:t.$t("cancel"),color:"negative",disabled:t.isBusy,size:"xl",icon:"cancel"},on:{click:t.goBack}}),o("icon-with-tooltip",{attrs:{tooltip:t.$t("save"),color:"positive",disabled:t.isBusy,size:"xl",icon:"check_circle"},on:{click:function(e){return t.saveOrUpdate()}}})],1)],1)],1)},s=[],r=(o("e6cf"),o("5440")),a=o("e118"),n=o("a010"),d=o("a31e"),l=o("51d9"),c=o("4f9d"),p=o("5e86"),u=o("7cbd"),m=o("5899c"),f=o("891a"),h=o("4e60"),E={name:"AddPost",components:{SelectFakeUser:h["a"],TooltipIcon:d["a"],ImageField:r["a"],TextField:a["a"],IconWithTooltip:l["a"],TagField:n["a"],YouTubeField:m["a"]},data(){return{postEditor:new c["a"],postApi:new u["a"],isBusy:!1,canBeViewed:!1}},computed:{me(){return f["a"].query().first()||{}},sectionsErrors(){return this.postEditor.validator.errors.sections},isEditing(){return"editPost"===this.$route.name},postId(){return this.$route.params.id},post(){return p["a"].query().withAll().find(this.postId)},tagError(){return this.postEditor.validator.errors.tags||null}},created(){this.me.is_verified||this.$root.$emit("verify-email"),this.postEditor.resetFormModel(),setTimeout((()=>{this.postEditor.addSection("text")}),10)},beforeDestroy(){this.postEditor.resetFormModel(),this.postEditor.validator.resetErrors()},methods:{goBack(){window.history.back()},fetchPost(){return new Promise(((t,e)=>{this.isBusy=!0,this.postApi.fetchPost(this.postId).then((e=>{this.isBusy=!1,t(e)})).catch((()=>{this.isBusy=!1}))}))},getSectionError(t){const e=this.postEditor.validator.errors.sections;return e&&"string"!==typeof e?e[t]:null},saveOrUpdate(){this.isBusy=!0,this.postEditor.saveOrUpdate(this.postId).then((t=>{this.isBusy=!1;const e=t.data,o=e.id;this.isEditing||(p["a"].insert({data:e}),this.$router.push({name:"editPost",params:{id:o}})),this.$q.notify({message:this.$t("success"),position:"center",color:"positive"})})).catch((()=>{this.isBusy=!1}))},updatePostTags(){this.postEditor.validator.resetFieldError("tags")},crtlSHandler(t){document.addEventListener("keydown",(t=>{t.ctrlKey&&"s"===t.key&&(t.preventDefault(),console.log("CTRL + S"))}))}}},v=E,g=o("2877"),y=o("f09f"),b=o("a370"),_=o("27f9"),k=o("74f7"),w=o("eebe"),$=o.n(w),x=Object(g["a"])(v,i,s,!1,null,null,null);e["default"]=x.exports;$()(x,"components",{QCard:y["a"],QCardSection:b["a"],QInput:_["a"],QInnerLoading:k["a"]})}}]);
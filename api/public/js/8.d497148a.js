(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{6357:function(r,e,s){"use strict";s.d(e,"a",(function(){return o}));var t=s("8847");class o{constructor(r){this.formModel=r,this.errors={error_message:null},this.formModel&&this.resetErrors()}setError(r,e){this.errors[r]=e[r]?e[r][0]:null}setErrors(r){const e=r.response.data.errors;if(e){for(const s in e)if(e.hasOwnProperty(s)){if("error_message"===s){this.errors.error_message=e[s];continue}this.errors[s]=e[s][0]||e[s]}}else{const e={invalid_grant:t["b"].messages[t["b"].locale].wrong_credentials,invalid_request:t["b"].messages[t["b"].locale].check_your_data},s=r.response.data.error;this.errors.error_message=e[s]||null}}resetFieldError(r,e){this.errors[r]&&(e?"string"===typeof this.errors[r]?this.errors[r]=null:this.errors[r][e]=null:this.errors[r]=null),this.errors.error_message=null}resetErrors(){for(const r in this.formModel)this.formModel.hasOwnProperty(r)&&(this.errors[r]=null)}}},b2c5:function(r,e,s){"use strict";s.r(e);var t=function(){var r=this,e=r.$createElement,s=r._self._c||e;return s("div",{staticClass:"row justify-center"},[s("div",{staticClass:"col-sm-12 col-xs-12 col-md-6 col-lg-4 col-xl-4"},[s("div",{staticClass:"flex column justify-center q-px-md",staticStyle:{height:"100vh"}},[s("q-form",{attrs:{dusk:"l-login-form"},on:{submit:r.onSubmit}},[s("q-card",[s("q-card-section",[s("div",{staticClass:"text-h6"},[r._v(r._s(r.$t("login")))])]),s("q-separator"),s("q-card-section",[s("q-input",{attrs:{dusk:"l-email-input",outlined:"",dense:"",autocomplete:"username",label:r.$t("email"),error:!!r.validator.errors.email,"error-message":r.validator.errors.email},on:{input:function(e){return r.validator.resetErrors()}},model:{value:r.form.email,callback:function(e){r.$set(r.form,"email",e)},expression:"form.email"}}),s("q-input",{attrs:{dusk:"l-password-input",outlined:"",dense:"",autocomplete:"current-password",type:"password",label:r.$t("password"),error:!!r.validator.errors.password,"error-message":r.validator.errors.password},on:{input:function(e){return r.validator.resetErrors()}},model:{value:r.form.password,callback:function(e){r.$set(r.form,"password",e)},expression:"form.password"}}),r.validator.errors.error_message?s("q-banner",{staticClass:"text-white bg-red q-mb-md",attrs:{dusk:"l-error-message",rounded:"","inline-actions":""}},[r._v("\n              "+r._s(r.validator.errors.error_message)+"\n            ")]):r._e(),s("q-item",{attrs:{dusk:"l-forgot-password-link",to:{name:"forgot_password"},clickable:""}},[s("q-item-section",[r._v(r._s(r.$t("forgot_your_password"))+"?")])],1)],1),s("q-separator"),s("q-card-actions",{staticClass:"q-pa-md"},[s("q-btn",{attrs:{dusk:"l-login-form-submit",disable:r.formIsBusy,loading:r.formIsBusy,label:r.$t("log_in"),type:"submit",color:"primary"}})],1)],1)],1)],1)])])},o=[],a=s("6357"),i=(s("e6cf"),s("77fc"));class n{constructor(){if(n.instance)return n.instance;this.api=new i["a"],this.token=null,this.expiresIn=null,n.instance=this}createToken(r,e){return new Promise(((s,t)=>{this.api.post("token",{grant_type:"password",client_id:2,client_secret:"sFKCIaMm0CcttGi21C2d3nYfzebevgB4owYad5SM",username:r,password:e}).then((r=>s(r))).catch((r=>{t(r)}))}))}refreshToken(){return new Promise(((r,e)=>{this.api.post("/oauth/token").then((e=>{r(e)})).catch((r=>{console.error(r),e(r)}))}))}}var l=s("ce77"),c=s("7a4a"),u=s("891a"),d=s("b65d");const m={email:null,password:null};var p={name:"Login",data(){return{form:m,formIsBusy:!1,validator:new a["a"](m),tokenApi:new n,userApi:new l["a"],tokenCookies:new c["a"],meCookies:new d["a"],api:new i["a"]}},methods:{onSubmit(){this.formIsBusy=!0,this.tokenApi.createToken(this.form.email,this.form.password).then((r=>{this.formIsBusy=!1,this.tokenCookies.set(r.data),this.api.setBearer(this.tokenCookies.getAuthorizationToken()),this.userApi.fetchMe().then((r=>{const e=r.data;this.meCookies.set(e),u["a"].create({data:e}),this.$router.push({name:"home"})}))})).catch((r=>{this.formIsBusy=!1,this.validator.setErrors(r)}))}}},h=p,f=s("2877"),w=s("0378"),g=s("f09f"),k=s("a370"),b=s("eb85"),v=s("27f9"),_=s("54e1"),y=s("66e5"),q=s("4074"),C=s("4b7e"),I=s("9c40"),x=s("eebe"),B=s.n(x),Q=Object(f["a"])(h,t,o,!1,null,null,null);e["default"]=Q.exports;B()(Q,"components",{QForm:w["a"],QCard:g["a"],QCardSection:k["a"],QSeparator:b["a"],QInput:v["a"],QBanner:_["a"],QItem:y["a"],QItemSection:q["a"],QCardActions:C["a"],QBtn:I["a"]})}}]);